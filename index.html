<!doctype html>
<html lang='en'>
<head>
  <meta charset='UTF-8'>
  <meta name='viewport'
        content='width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0'>
  <meta http-equiv='X-UA-Compatible' content='ie=edge'>
  <title>Document</title>
</head>
<body>
<script>
  fetch('manifest.json')
    .then(res => res.json())
    .then((res) => {
      console.log(res);
      Object.entries(res).forEach(([name, apps])=>{
        Object.entries(apps).forEach(([_, files])=>{
          Object.entries(files).forEach(([type, file])=>{
            console.log(type, file)
            const scriptTag = document.createElement('script');
            scriptTag.type = 'application/javascript';
            scriptTag.src = file;
            scriptTag.defer = 'defer';
            console.log('script', file)
            document.querySelector('body').appendChild(scriptTag);
          })
        })
      })

      // Object.entries(res).forEach(([moduleName, mod]) => {
      //   // if (moduleName === 'core') return;
      //   Object.entries(mod).forEach(([name, script]) => {
      //     if (name.includes('index.html')) return;
      //     if (typeof script === 'object') return;
      //     const scriptTag = document.createElement('script');
      //     scriptTag.type = 'application/javascript';
      //     scriptTag.src = script;
      //     console.log('script', script)
      //     document.querySelector('body').appendChild(scriptTag);
      //     count++;
      //   });
      // });
    }).catch(e => {
    console.error(e);
  });
</script>
</body>
</html>